# ğŸŒ Day 6 â€“ Other Common Web Vulnerabilities

Today we explored **four frequent but often overlooked vulnerabilities** that appear across real-world web applications. These issues are usually simpler than SQLi or XSS, but they can still lead to severe impact when chained with other attacks.

---

## ğŸ”¹ 1. Cross-Site Request Forgery (CSRF)

**Concept**

- CSRF forces a logged-in user to perform unintended actions on a web application.
- Because browsers **automatically send cookies** with requests, a malicious website can trigger sensitive actions without user consent.

**Example Attack**

Imagine a banking site where this URL changes your email:

```
POST /change-email HTTP/1.1
Host: bank.com
email=attacker@evil.com

```

If no CSRF protection exists, an attacker can embed this in a page:

```html
<form action="http://bank.com/change-email" method="POST">
  <input type="hidden" name="email" value="attacker@evil.com">
  <input type="submit" value="Click me!">
</form>

```

When a logged-in victim loads it, their account email silently changes.

**Defenses**

- Use anti-CSRF tokens.
- Require re-authentication for sensitive actions.
- Set cookies with `SameSite` attribute.

---

## ğŸ”¹ 2. File Upload Attacks

**Concept**

- Upload features are a double-edged sword: convenient for users, dangerous for servers.
- Attackers attempt to upload malicious files (e.g., PHP web shells) disguised as images.

**Common Bypasses**

- Double extension â†’ `shell.php.jpg`
- MIME mismatch â†’ file header claims to be an image
- Null byte trick â†’ `shell.php%00.jpg`

**Impact**

- If executed, an attacker gains remote code execution.
- Even if not executed, malicious files can still harm other users (XSS in uploaded HTML, malware distribution).

**Defenses**

- Store uploads outside webroot.
- Validate file type by inspecting **content**, not just extension.
- Rename files on upload.

---

## ğŸ”¹ 3. Directory Traversal

**Concept**

- Happens when user input is concatenated into file paths without sanitization.
- Attackers use sequences like:
    
    ```
    ../../../../etc/passwd
    
    ```
    
- Goal: escape the intended folder and access restricted files.

**Example**

```
GET /download?file=../../../../etc/passwd

```

If unprotected, the server might leak the systemâ€™s password file.

**Defenses**

- Normalize and validate paths.
- Whitelist allowed directories.
- Never trust raw user input for file access.

---

## ğŸ”¹ 4. Open Redirects

**Concept**

- Occurs when an application blindly redirects based on user input.
- Example:
    
    ```
    http://site.com/redirect?url=http://evil.com
    
    ```
    
- Attackers abuse this to **trick users into phishing pages** while making the link look legitimate.

**Impact**

- Facilitates phishing, malware delivery.
- Sometimes chained into OAuth or SSO attacks.

**Defenses**

- Only allow redirects to internal paths.
- Use a whitelist for valid destinations.

---

## ğŸ“Œ Key Takeaways

- **CSRF**: Exploits browser trust in cookies â†’ defend with tokens & SameSite.
- **File Upload Attacks**: Dangerous if executable files slip through â†’ defend with strict validation and safe storage.
- **Directory Traversal**: Classic but still alive â†’ always validate file paths.
- **Open Redirects**: Often underestimated â†’ can enable large-scale phishing.