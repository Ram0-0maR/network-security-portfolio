# Kenobi Target – Penetration Test Report

## 1️⃣ Executive Summary
This assessment focused on the **“Kenobi”** target machine, simulating an internal penetration test to evaluate system and user security. During the test, multiple vectors were explored, including **initial access**, **privilege escalation**, and **system misconfigurations**.  

Key findings include the presence of **SUID binaries**, **writable directories**, and **exploitable scripts**, allowing escalation from a standard user (`kenobi`) to root. Immediate remediation steps are recommended to reduce potential attack surfaces.

---

## 2️⃣ Methodology

### Phase 1 – Recon & Initial Access
- Collected system information: `whoami`, `id`, `hostname`, `uname -a`, `lsb_release -a`.  
- Scanned services and open ports using **Nmap** and FTP tools.  
- Extracted credentials where available (via **NFS share** and **RSA key**).  
- Successfully SSHed into the target as `kenobi` using `id_rsa`.

### Phase 2 – Privilege Escalation
- Checked sudo permissions: `sudo -l`  
- Enumerated SUID binaries:
  ```bash
  find / -perm -4000 -type f 2>/dev/null
  ```  
- Checked file capabilities:
  ```bash
  getcap -r / 2>/dev/null
  ```  
- Inspected cron jobs: `/etc/crontab`, `/etc/cron.*`, `systemctl list-timers`  
- Identified writable directories for potential attack vectors: `/tmp`, `/var/tmp`, `/var/lib/samba/usershares`  
- Explored processes: `ps aux --forest`  
- Discovered root-owned executable `/usr/bin/menu` and exploited via **PATH hijacking**.

### Phase 3 – Exploitation
- Created a malicious shell script in `/tmp` to hijack `$PATH`.  
- Exported `/tmp` as first in `$PATH` and executed `/usr/bin/menu`.  
- Successfully escalated privileges to **root**.

---

## 3️⃣ Findings

| Vulnerability / Issue       | Location / Binary                           | Risk Level   | Details |
| --------------------------- | ------------------------------------------ | ------------ | ------- |
| Weak SUDO configuration     | `sudo -l`                                  | Medium       | `kenobi` has sudo permissions for some commands; review sudoers file. |
| SUID Binaries               | `/usr/bin/pkexec`, `/usr/bin/menu`         | High         | `pkexec` vulnerable to exploitation. `menu` script executed as root. |
| Writable Directories        | `/tmp`, `/var/tmp`, `/var/lib/samba/usershares` | Medium   | Allows arbitrary script creation leading to escalation. |
| Cron Jobs                   | `/etc/crontab`, `/etc/cron.*`              | Low-Medium   | Could be leveraged if scripts are writable or misconfigured. |
| Exposed Credentials         | NFS share (`id_rsa`)                        | High         | SSH access with private key allows initial compromise. |

---

## 4️⃣ Recommendations
- **SUDO Configuration:** Restrict sudo permissions to minimum necessary; avoid wildcard commands.  
- **SUID Binaries:** Audit all SUID binaries and remove unnecessary ones.  
- **Writable Directories:** Restrict write permissions on sensitive directories.  
- **Cron Jobs:** Ensure scripts run by cron are owned by root and not writable by other users.  
- **Credential Management:** Avoid storing private keys on shared directories; enforce key encryption.  
- **General Hardening:** Apply security patches, disable unused services, and monitor for unusual activity.
